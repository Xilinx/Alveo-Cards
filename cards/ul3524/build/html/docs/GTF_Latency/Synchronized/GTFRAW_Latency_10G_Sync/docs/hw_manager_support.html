<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>GTF RAW Synchronized Latency Measurement in Hardware &mdash; Ultra Low Latency Trading UL3524 documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../../index.html" class="icon icon-home"> Ultra Low Latency Trading
            <img src="../../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                UL3524
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">UL3524</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Alveo-Cards/cards/ul3524.html">Home</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/Alveo-Cards/tree/ul3524">On GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Designs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html">GTF Latency Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../RECOV_CLK/README.html">GTF Recovery Clock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../PCIE_DDR/README.html">PCIE DDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../QDR_MIG/README.html">QDR MIG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../QSFP_I2C/README.html">QSFP I2C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Renesas_I2C_Programming/README.html">Renesas I2C Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../FINN_Latency/README.html">FINN_Latency</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Design Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Docs/loading_ref_proj.html">Loading a design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Docs/simulating_a_design.html">Simulating a design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Docs/building_a_design.html">Building a design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Docs/programming_the_device.html">Programming the device</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vivado Design Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Docs/vivado_design_flow.html">Vivado Design Flow</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Ultra Low Latency Trading</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>GTF RAW Synchronized Latency Measurement in Hardware</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/docs/GTF_Latency/Synchronized/GTFRAW_Latency_10G_Sync/docs/hw_manager_support.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table class="sphinxhide" width="100%">
 <tr width="100%">
    <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>UL3524 Ultra Low Latency Trading</h1>
    </td>
 </tr>
</table><div class="section" id="gtf-raw-synchronized-latency-measurement-in-hardware">
<h1>GTF RAW Synchronized Latency Measurement in Hardware<a class="headerlink" href="#gtf-raw-synchronized-latency-measurement-in-hardware" title="Permalink to this heading">¶</a></h1>
<p>This section provides steps to run the GTF RAW benchmark design and to measure and report GTF RAW latency on the UL3524 via the Vivado HW Manager.</p>
<p>The key steps to run the benchmark design are:</p>
<ol class="simple">
<li><p>Program the device</p></li>
</ol>
<ul class="simple">
<li><p>Program the UL3524 with the bitstream (.bit) and ILA (.ltx).</p></li>
<li><p>(Optional) Enable ILA to capture and view waveforms</p></li>
</ul>
<ol class="simple">
<li><p>Run the latency measurement test</p></li>
</ol>
<ul class="simple">
<li><p>A Tcl-based script allows running the design in hardware.  It initializes the GTF, transfers a predefined number of frames and computes latency based on the recorded TX and RX timestamps.</p></li>
</ul>
<p>These steps are described in detail below.</p>
<div class="section" id="programming-the-device">
<h2>Programming the Device<a class="headerlink" href="#programming-the-device" title="Permalink to this heading">¶</a></h2>
<p>It is necessary to program the device prior to running the GTF benchmark design.  <strong>Be sure to build the design prior to following these steps.</strong></p>
<ol class="simple">
<li><p><a class="reference internal" href="../../../../Docs/programming_the_device.html"><span class="doc">Connect to the card via the HW Manager and program the FPGA</span></a> with the bitfile (<em>.bit) and ILA debug (</em>.ltx) files located in the following sub-directory (assumes the design was built within <em>Vivado_Project</em>:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">./Vivado_Project/&lt;project_name&gt;/&lt;project_name&gt;.runs/impl_1/</span></code></p></li>
</ul>
</div>
<div class="section" id="running-the-latency-measurement-test">
<h2>Running the Latency Measurement Test<a class="headerlink" href="#running-the-latency-measurement-test" title="Permalink to this heading">¶</a></h2>
<p>Instructions to run the GTF latency measurement test are given below.</p>
<ol class="simple">
<li><p>In the Vivado Tcl console, change the working directory to:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">./GTF_Latency/Synchronized/GTFRAW_Latency_10G_Sync/Scripts</span></code></p></li>
</ul>
</li>
<li><p>Use the following command to run the Tcl script.  When the has completed, it will display ‘Complete’ in the Tcl console.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">./run_tests.tcl</span></code></p></li>
</ul>
</li>
<li><p>Once the test is complete, you can review the output log found in the following directory.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">./GTF_Latency/Synchronized/GTFRAW_Latency_10G_Sync/Scripts/Test_Output</span></code></p></li>
</ul>
</li>
</ol>
<div class="section" id="example-output-files">
<h3>Example Output Files<a class="headerlink" href="#example-output-files" title="Permalink to this heading">¶</a></h3>
<p>Two output files are generated in the “Test_Output” folder once we run the run_tests.tcl. A csv file and a log file.They have the same contents but in a different format.</p>
<p>An example of the generated output log from <code class="docutils literal notranslate"><span class="pre">run_tests.tcl</span></code> is shown below.  There will be <strong>num_test</strong> tests, with each test transferring <strong>pkt_cnt</strong> frames.  In the example output below, <strong>num_test</strong> is 10 and <strong>pkt_cnt</strong> is 250.  These and other parameters can be changed from their default values if needed. For more information regarding the test parameters, please refer <a class="reference external" href="../Scripts/README.html#test-parameters">the scripts documentation</a>.</p>
<p>Each line displays the minimum, average and maximum (min/avg/max) measured latency values for a given test along with the latency distributions in terms of clock cycles. The average latency value is the sum of all latency values for a test, divided by <strong>pck_cnt</strong>.</p>
<p>Variations in the measured latency values are expected and describe <a class="reference external" href="../../../README.html#variations-on-measured-latency">here</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">==========================================================================================</span>
Test Number: <span class="m">0</span>
Latency <span class="o">(</span>min/avg/max<span class="o">)</span>:  <span class="m">1</span>.500ns / <span class="m">1</span>.500ns / <span class="m">1</span>.500ns
Clk Cnts  <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>  / <span class="m">250</span>  / <span class="m">0</span> / <span class="m">0</span>
Percent   <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>% / <span class="m">100</span>% / <span class="m">0</span>% / <span class="m">0</span>%
<span class="o">==========================================================================================</span>

<span class="o">==========================================================================================</span>
Test Number: <span class="m">1</span>
Latency <span class="o">(</span>min/avg/max<span class="o">)</span>:  <span class="m">1</span>.500ns / <span class="m">1</span>.500ns / <span class="m">1</span>.500ns
Clk Cnts  <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>  / <span class="m">250</span>  / <span class="m">0</span> / <span class="m">0</span>
Percent   <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>% / <span class="m">100</span>% / <span class="m">0</span>% / <span class="m">0</span>%
<span class="o">==========================================================================================</span>

<span class="o">==========================================================================================</span>
Test Number: <span class="m">2</span>
Latency <span class="o">(</span>min/avg/max<span class="o">)</span>:  <span class="m">1</span>.500ns / <span class="m">1</span>.500ns / <span class="m">1</span>.500ns
Clk Cnts  <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>  / <span class="m">250</span>  / <span class="m">0</span> / <span class="m">0</span>
Percent   <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>% / <span class="m">100</span>% / <span class="m">0</span>% / <span class="m">0</span>%
<span class="o">==========================================================================================</span>

<span class="o">==========================================================================================</span>
Test Number: <span class="m">3</span>
Latency <span class="o">(</span>min/avg/max<span class="o">)</span>:  <span class="m">1</span>.500ns / <span class="m">1</span>.500ns / <span class="m">1</span>.500ns
Clk Cnts  <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>  / <span class="m">250</span>  / <span class="m">0</span> / <span class="m">0</span>
Percent   <span class="o">(</span><span class="m">0</span>.5, <span class="m">1</span>.5, <span class="m">2</span>.5, <span class="m">3</span>.5<span class="o">)</span>: <span class="m">0</span>% / <span class="m">100</span>% / <span class="m">0</span>% / <span class="m">0</span>%
<span class="o">==========================================================================================</span>
</pre></div>
</div>
<p><strong>Figure:</strong> Example log output</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
<span class="m">1</span>.500,1.500,1.500
</pre></div>
</div>
<p><strong>Figure:</strong> Example csv output</p>
</div>
</div>
<div class="section" id="ila">
<h2>ILA<a class="headerlink" href="#ila" title="Permalink to this heading">¶</a></h2>
<p>An ILA is included in the design to allow one to observe and verify the behavior of the design on HW. The ILA in the design is connected to the Rx PRBS error detection logic.</p>
<p>The ILA, all the signals are clocked by <code class="docutils literal notranslate"><span class="pre">RXUSRCLK</span></code>, and TXDATAIN is the sampled TxRawData bus sampled in the Rx clock domain. The two clocks have the same frequency and are 180 degrees out of phase in order to provide consistant delays for clock domain crossing.</p>
<p><strong>NOTE</strong>: It is necessary to enable ILAs in order to capture and view the waveforms.</p>
<p>The following <strong>hw_ila_1</strong> example waveform shows the latency measurement on HW.</p>
<p><img alt="gtfraw_phase_timing_ila" src="../../../../../_images/gtfraw_phase_timing_ila.png" /></p>
<p>The <em>sent_time</em> and the <em>rcvd_time</em> are latched when a sent or receive event is received respectively.</p>
<p>The <em>delta_time</em> is calculated as follows:</p>
<p><em>delta_time</em> = abs(<em>sent_time</em> + <em>rcvd_time</em>) - 6.5</p>
<p>where the measurement is compensated for the fact that</p>
<ul class="simple">
<li><p>the TX sent event was sync’d from the Tx domain (-0.5 clock),</p></li>
<li><p>RX data is launched off of the preceding <code class="docutils literal notranslate"><span class="pre">RXUSRCLK</span></code> (-1.0 clock), and</p></li>
<li><p>RX data detection pipeline (-4.0 clock)</p></li>
<li><p>Edge sample delay to trigger receive event (-1.0 clock)</p></li>
</ul>
<p>It also shows the corrupted PRBS value (inverted 0x0004) that identifies the start of the latency measurement.</p>
<p>It also shows when the corrupted word is detected in the Rx PRBS monitor (expected value is 0x0004, actual value is 0xFFFB).</p>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this heading">¶</a></h2>
<p>For additional documentation, please refer to the <a class="reference external" href="https://www.xilinx.com/products/boards-and-kits/alveo/ul3524.html">UL3524 product page</a> and the <a class="reference external" href="https://www.xilinx.com/member/ull-ea.html">UL3524 Lounge</a>.</p>
<p>For support, contact your FAE or refer to support resources at: <a class="reference external" href="https://support.xilinx.com">https://support.xilinx.com</a></p>
<p class="sphinxhide" align="center"><sub>Copyright © 2020–2023 Advanced Micro Devices, Inc</sub></p><p class="sphinxhide" align="center"><sup><a href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a></sup></p></div>
</div>


           </div>
          </div>
          
				  
				  <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on September 28, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>